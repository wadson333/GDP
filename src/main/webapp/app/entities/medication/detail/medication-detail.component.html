<!-- <div class="d-flex justify-content-center">
  <div class="col-8">
    @if (medication; as medicationRef) {
      <div>
        <h2 data-cy="medicationDetailsHeading"><span jhiTranslate="gdpApp.medication.detail.title">Medication</span></h2>

        <hr />

        <jhi-alert-error></jhi-alert-error>

        <jhi-alert></jhi-alert>

        <dl class="row-md jh-entity-details">
          <dt><span jhiTranslate="global.field.id">ID</span></dt>
          <dd>
            <span>{{ medicationRef.id }}</span>
          </dd>
          <dt><span [ngbTooltip]="'gdpApp.medication.help.name' | translate" jhiTranslate="gdpApp.medication.name">Name</span></dt>
          <dd>
            <span>{{ medicationRef.name }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.internationalName' | translate" jhiTranslate="gdpApp.medication.internationalName"
              >International Name</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.internationalName }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.codeAtc' | translate" jhiTranslate="gdpApp.medication.codeAtc">Code Atc</span>
          </dt>
          <dd>
            <span>{{ medicationRef.codeAtc }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.formulation' | translate" jhiTranslate="gdpApp.medication.formulation"
              >Formulation</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.formulation }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.strength' | translate" jhiTranslate="gdpApp.medication.strength">Strength</span>
          </dt>
          <dd>
            <span>{{ medicationRef.strength }}</span>
          </dd>
          <dt>
            <span
              [ngbTooltip]="'gdpApp.medication.help.routeOfAdministration' | translate"
              jhiTranslate="gdpApp.medication.routeOfAdministration"
              >Route Of Administration</span
            >
          </dt>
          <dd>
            <span [jhiTranslate]="'gdpApp.RouteAdmin.' + (medicationRef.routeOfAdministration ?? 'null')">{{
              {
                null: '',
                ORAL: 'ORAL',
                INTRAVENOUS: 'INTRAVENOUS',
                SUBCUTANEOUS: 'SUBCUTANEOUS',
                INHALATION: 'INHALATION',
                TOPICAL: 'TOPICAL',
                OTHER: 'OTHER',
              }[medicationRef.routeOfAdministration ?? 'null']
            }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.manufacturer' | translate" jhiTranslate="gdpApp.medication.manufacturer"
              >Manufacturer</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.manufacturer }}</span>
          </dd>
          <dt>
            <span
              [ngbTooltip]="'gdpApp.medication.help.marketingAuthorizationNumber' | translate"
              jhiTranslate="gdpApp.medication.marketingAuthorizationNumber"
              >Marketing Authorization Number</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.marketingAuthorizationNumber }}</span>
          </dd>
          <dt>
            <span
              [ngbTooltip]="'gdpApp.medication.help.marketingAuthorizationDate' | translate"
              jhiTranslate="gdpApp.medication.marketingAuthorizationDate"
              >Marketing Authorization Date</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.marketingAuthorizationDate | formatMediumDatetime }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.packaging' | translate" jhiTranslate="gdpApp.medication.packaging">Packaging</span>
          </dt>
          <dd>
            <span>{{ medicationRef.packaging }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.prescriptionStatus' | translate" jhiTranslate="gdpApp.medication.prescriptionStatus"
              >Prescription Status</span
            >
          </dt>
          <dd>
            <span [jhiTranslate]="'gdpApp.PrescriptionStatus.' + (medicationRef.prescriptionStatus ?? 'null')">{{
              { null: '', PRESCRIPTION: 'PRESCRIPTION', OTC: 'OTC', HOSPITAL_USE_ONLY: 'HOSPITAL_USE_ONLY' }[
                medicationRef.prescriptionStatus ?? 'null'
              ]
            }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.description' | translate" jhiTranslate="gdpApp.medication.description"
              >Description</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.description }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.expiryDate' | translate" jhiTranslate="gdpApp.medication.expiryDate"
              >Expiry Date</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.expiryDate | formatMediumDatetime }}</span>
          </dd>
          <dt><span [ngbTooltip]="'gdpApp.medication.help.barcode' | translate" jhiTranslate="gdpApp.medication.barcode">Barcode</span></dt>
          <dd>
            <span>{{ medicationRef.barcode }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.storageCondition' | translate" jhiTranslate="gdpApp.medication.storageCondition"
              >Storage Condition</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.storageCondition }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.unitPrice' | translate" jhiTranslate="gdpApp.medication.unitPrice">Unit Price</span>
          </dt>
          <dd>
            <span>{{ medicationRef.unitPrice }}</span>
          </dd>
          <dt><span [ngbTooltip]="'gdpApp.medication.help.image' | translate" jhiTranslate="gdpApp.medication.image">Image</span></dt>
          <dd>
            <span>{{ medicationRef.image }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.composition' | translate" jhiTranslate="gdpApp.medication.composition"
              >Composition</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.composition }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.contraindications' | translate" jhiTranslate="gdpApp.medication.contraindications"
              >Contraindications</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.contraindications }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.sideEffects' | translate" jhiTranslate="gdpApp.medication.sideEffects"
              >Side Effects</span
            >
          </dt>
          <dd>
            <span>{{ medicationRef.sideEffects }}</span>
          </dd>
          <dt><span [ngbTooltip]="'gdpApp.medication.help.active' | translate" jhiTranslate="gdpApp.medication.active">Active</span></dt>
          <dd>
            <span>{{ medicationRef.active }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.isGeneric' | translate" jhiTranslate="gdpApp.medication.isGeneric">Is Generic</span>
          </dt>
          <dd>
            <span>{{ medicationRef.isGeneric }}</span>
          </dd>
          <dt>
            <span [ngbTooltip]="'gdpApp.medication.help.riskLevel' | translate" jhiTranslate="gdpApp.medication.riskLevel">Risk Level</span>
          </dt>
          <dd>
            <span [jhiTranslate]="'gdpApp.RiskLevel.' + (medicationRef.riskLevel ?? 'null')">{{
              { null: '', LOW: 'LOW', MODERATE: 'MODERATE', HIGH: 'HIGH', UNKNOWN: 'UNKNOWN' }[medicationRef.riskLevel ?? 'null']
            }}</span>
          </dd>
        </dl>

        <button type="submit" (click)="previousState()" class="btn btn-info" data-cy="entityDetailsBackButton">
          <fa-icon icon="arrow-left"></fa-icon>&nbsp;<span jhiTranslate="entity.action.back">Retour</span>
        </button>

        <button type="button" [routerLink]="['/medication', medicationRef.id, 'edit']" class="btn btn-primary">
          <fa-icon icon="pencil-alt"></fa-icon>&nbsp;<span jhiTranslate="entity.action.edit">Editer</span>
        </button>
      </div>
    }
  </div>
</div> -->

<div class="surface-section py-2 px-2 medication-detail-container">
  @if (medication) {
    <div class="flex justify-end mb-1">
      <button
        pButton
        type="button"
        class="p-button-text"
        (click)="exportDetailsToPdf()"
        icon="pi pi-file-export"
        [pTooltip]="'gdpApp.medication.detail.action.exportDetails' | translate"
      ></button>
    </div>
    <p-tabView [(activeIndex)]="activeTab" styleClass="medication-detail-tabs">
      <!-- General Tab -->
      <p-tabPanel [header]="'gdpApp.medication.detail.tabs.general' | translate">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Basic Info -->
          <div class="col-span-full">
            <div class="flex surface-ground border-round">
              <div class="flex-grow flex gap-4 items-start">
                <!-- Image -->
                <div class="w-24 h-24 flex items-center justify-center bg-surface-50 rounded-lg overflow-hidden">
                  <img
                    *ngIf="medication.image"
                    src="../../../../content/images/medication.jpg"
                    [alt]="medication.name"
                    class="w-full h-full object-cover"
                  />
                  <i *ngIf="!medication.image" class="pi pi-image text-4xl text-surface-400"></i>
                </div>

                <!-- Name and Status -->
                <div class="flex-grow">
                  <div class="text-sm font-bold mb-1">#{{ medication.id }}</div>
                  <h3 class="text-xl font-semibold mb-2">{{ medication.name }}</h3>
                  <div class="flex gap-2 flex-wrap">
                    <p-tag
                      *ngIf="medication.prescriptionStatus"
                      [severity]="'info'"
                      [value]="'gdpApp.PrescriptionStatus.' + medication.prescriptionStatus | translate"
                    >
                    </p-tag>
                    <p-badge *ngIf="isExpired()" severity="danger" [value]="'gdpApp.medication.detail.status.expired' | translate">
                    </p-badge>
                    <p-badge *ngIf="isNearExpiry()" severity="warning" [value]="'gdpApp.medication.detail.status.nearExpiry' | translate">
                    </p-badge>
                  </div>
                </div>
              </div>
              @if (medication.barcode) {
                <div class="self-end surface-ground border-round">
                  <div class="flex flex-col items-center p-3 bg-white dark:bg-surface-800 rounded-lg">
                    <ngx-barcode6
                      [bc-value]="medication.barcode"
                      [bc-display-value]="true"
                      [bc-width]="1.5"
                      [bc-height]="50"
                      [bc-font-size]="12"
                      [bc-margin-top]="10"
                      [bc-margin-bottom]="10"
                    ></ngx-barcode6>
                  </div>
                </div>
              }
            </div>
          </div>
          <div class="col-span-full px-4">
            <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.description' | translate }}</label>
            <p class="whitespace-pre-line">{{ medication.description || '-' }}</p>
          </div>
          <div class="col-span-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Add all fields in a organized way -->
            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.internationalName' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.internationalName || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.codeAtc' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.codeAtc || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.formulation' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.formulation || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.strength' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.strength || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.routeOfAdministration' | translate }}</label>
              <div class="text-surface-900 font-semibold">
                {{ medication.routeOfAdministration ? ('gdpApp.RouteAdmin.' + medication.routeOfAdministration | translate) : '-' }}
              </div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.manufacturer' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.manufacturer || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.marketingAuthorizationNumber' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.marketingAuthorizationNumber || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.marketingAuthorizationDate' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.marketingAuthorizationDate | formatMediumDate }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.packaging' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.packaging || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.barcode' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.barcode || '-' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.unitPrice' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.unitPrice | currency: 'HTG' }}</div>
            </div>

            <div class="p-4 surface-ground border-round">
              <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.expiryDate' | translate }}</label>
              <div class="text-surface-900 font-semibold">{{ medication.expiryDate | formatMediumDate }}</div>
            </div>
          </div>
        </div>
      </p-tabPanel>

      <!-- Medical Information Tab -->
      <p-tabPanel [header]="'gdpApp.medication.detail.tabs.medical' | translate">
        <p-accordion>
          <!-- Composition -->
          <p-accordionTab [header]="'gdpApp.medication.composition' | translate">
            <p class="whitespace-pre-line">{{ medication.composition }}</p>
          </p-accordionTab>

          <!-- Contraindications -->
          <p-accordionTab [header]="'gdpApp.medication.contraindications' | translate">
            <p class="whitespace-pre-line">{{ medication.contraindications }}</p>
          </p-accordionTab>

          <!-- Side Effects -->
          <p-accordionTab [header]="'gdpApp.medication.sideEffects' | translate">
            <p class="whitespace-pre-line">{{ medication.sideEffects }}</p>
          </p-accordionTab>

          <!-- Storage Conditions -->
          <p-accordionTab [header]="'gdpApp.medication.storageCondition' | translate">
            <p class="whitespace-pre-line">{{ medication.storageCondition }}</p>
          </p-accordionTab>
        </p-accordion>
      </p-tabPanel>

      <!-- Audit Tab -->
      <p-tabPanel [header]="'gdpApp.medication.detail.tabs.audit' | translate">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Created Info -->
          <div class="p-4 surface-ground border-round">
            <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.detail.audit.createdBy' | translate }}</label>
            <div class="text-surface-900">{{ medication.createdBy }}</div>
            <div class="text-sm text-surface-600 font-semibold mt-1">
              {{ medication.createdDate | date: 'medium' }}
            </div>
          </div>

          <!-- Modified Info -->
          <div class="p-4 surface-ground border-round">
            <label class="block text-sm font-medium mb-2">{{ 'gdpApp.medication.detail.audit.lastModifiedBy' | translate }}</label>
            <div class="text-surface-900">{{ medication.lastModifiedBy }}</div>
            <div class="text-sm text-surface-600 mt-1 font-semibold">
              {{ medication.lastModifiedDate | date: 'medium' }}
            </div>
          </div>
        </div>
      </p-tabPanel>
    </p-tabView>
  }
</div>
